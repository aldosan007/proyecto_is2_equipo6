  CREATE TABLE "DEMO_ESPACIO_TRABAJO" 
   (	"COD_ESPACIO_TRABAJO" NUMBER(8,0) GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"DESCRIPCION" VARCHAR2(250 CHAR) NOT NULL ENABLE, 
	"USERID" NUMBER(8,0) NOT NULL ENABLE, 
	"ABREVIATURA" VARCHAR2(250), 
	"ESTADO" VARCHAR2(30) DEFAULT 'A', 
	 CONSTRAINT "DEMO_ESPACIO_TRABAJO_PK" PRIMARY KEY ("COD_ESPACIO_TRABAJO")
  USING INDEX  ENABLE
   ) ;

  ALTER TABLE "DEMO_ESPACIO_TRABAJO" ADD CONSTRAINT "DEMO_ESPACIO_TRABAJO_CON" FOREIGN KEY ("USERID")
	  REFERENCES "DEMO_USERS" ("USERID") ENABLE;

  CREATE OR REPLACE EDITIONABLE TRIGGER "TG_DEMO_ESPACIO_TRABAJO_VALIDAR_ESTADO" 
BEFORE UPDATE ON DEMO_ESPACIO_TRABAJO
FOR EACH ROW
BEGIN
    IF(:NEW.estado != :OLD.estado AND :NEW.userid != :OLD.userid) OR (:NEW.userid != :OLD.userid) THEN
    RAISE_APPLICATION_ERROR(-20001, 'Solo el usuario creador del espacio puede cambiar de estado');
  END IF;
END;
/
ALTER TRIGGER "TG_DEMO_ESPACIO_TRABAJO_VALIDAR_ESTADO" ENABLE;
  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_DEMO_ESPACIO_USER" 
AFTER INSERT ON DEMO_ESPACIO_TRABAJO
FOR EACH ROW
BEGIN
   -- Si no se especifica un ID en el INSERT, toma el siguiente valor de la secuencia
   INSERT INTO DEMO_ESPACIO_USER (COD_ESPACIO_TRABAJO,USERID,ESTADO)
   VALUES (:NEW.COD_ESPACIO_TRABAJO, :NEW.USERID,'A');
END;
/
ALTER TRIGGER "TRG_DEMO_ESPACIO_USER" ENABLE;